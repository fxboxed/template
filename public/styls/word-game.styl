// public/styls/word-game.styl
// State color rules (YOUR mapping):
// - correct  => safe
// - present  => warning
// - absent   => danger
// (Use the actual words safe/warning/danger in the CSS.)

.wordle-game-wrap
  background rgba(alpha - 60%, 0.08)
  width fit-content
  margin 0rem auto
  padding 0

  .wordle-game
    max-width 424px
    margin 0 auto
    border-radius 16px
    width 100vw
    background rgba(alpha - 70%, 0.08)
    border 1px solid rgba(alpha + 20%, 0.14)

    .game-header
      display flex
      flex-direction column
      align-items center
      gap 0
      margin-bottom 14px
      line-height 1
      position relative
      z-index 3
      padding 12px 12px 0 12px

      .game-title
        margin 0
        width 100%
        font-size clamp(22px, 2.4vw, 34px)
        line-height 1
        height 4rem
        display flex
        align-items center
        justify-content center
        text-align center
        border-bottom 1px solid rgba(alpha + 30%, 0.22)
        color alpha + 60%

      .previous-answers-wrap
        position relative
        margin-top .6rem
        width 100%
        display flex
        flex-direction column
        align-items center
        z-index 50

      .previous-answer-btn
        padding 8px 12px
        border 1px solid rgba(alpha + 30%, 0.24)
        border-radius 10px
        background rgba(alpha - 70%, 0.14)
        color alpha + 60%
        cursor pointer
        width fit-content
        margin-bottom .6rem

        &:hover
          background rgba(alpha - 70%, 0.18)

        &:active
          transform translateY(1px)

      .previous-answers
        position absolute
        top calc(100% + 8px)
        left 50%
        transform translateX(-50%) translateY(-8px) scale(.98)
        opacity 0
        pointer-events none
        width min(424px, 96vw)
        border 1px solid rgba(alpha + 20%, 0.18)
        border-radius 12px
        background rgba(alpha - 80%, 0.22)
        color alpha + 60%
        padding 10px
        box-sizing border-box
        z-index 60
        transition opacity 800ms ease, transform 800ms ease
        will-change opacity, transform
        box-shadow 0 12px 30px rgba(dark, 0.18)

        &.is-open
          opacity 1
          transform translateX(-50%) translateY(0) scale(1)
          pointer-events auto

        .previous-answers-head
          display flex
          justify-content space-between
          align-items center
          margin-bottom 8px

          .previous-answers-title
            font-weight 700
            opacity .95

        .previous-answers-status
          margin 0 0 8px 0
          padding 6px 8px
          border-radius 10px
          background rgba(alpha - 70%, 0.14)
          border 1px solid rgba(alpha + 20%, 0.14)
          opacity .95

        .previous-answers-list
          list-style none
          padding 0
          margin 0
          display grid
          gap 6px

          li
            display flex
            justify-content space-between
            align-items center
            flex-wrap nowrap
            gap 12px
            padding 6px 8px
            border-radius 10px
            background rgba(alpha - 70%, 0.14)
            border 1px solid rgba(alpha + 20%, 0.12)
            white-space nowrap

            .prev-date
              opacity .9
              font-variant-numeric tabular-nums
              white-space nowrap
              overflow hidden
              text-overflow ellipsis
              min-width 0
              flex 1 1 auto

            .prev-answer
              font-weight 800
              letter-spacing .08em
              text-transform uppercase
              font-variant-numeric tabular-nums
              white-space nowrap
              flex 0 0 auto

      .sub-heading
        position relative
        display flex
        flex-direction column
        align-items center
        justify-content center
        width 100%
        margin-top .35rem

      .timer-line,
      .attempts-line,
      .streak-line
        margin 0
        opacity 0.92
        margin auto
        color alpha + 50%

      .countdown
        margin-left 8px
        font-variant-numeric tabular-nums

      .attempts-line span
        margin-left 8px
        font-variant-numeric tabular-nums

      .puzzle-picker
        margin-top .35rem

        label
          margin-right 8px
          color alpha + 50%

        select
          border 1px solid rgba(alpha + 20%, 0.2)
          border-radius 10px
          background rgba(alpha - 70%, 0.12)
          color alpha + 60%
          padding 6px 10px

    .game-stage
      padding 0 12px

      .wordle
        display grid
        gap 18px
        align-items start
        position relative
        z-index 1

        .wordle-board
          display grid
          gap 8px
          justify-content center
          user-select none
          touch-action manipulation
          position relative

          .wordle-row-toast-host
            position absolute
            left 1.1rem
            right 1.1rem
            top 0
            z-index 6
            pointer-events none

          .wordle-row-toast
            opacity 0
            transform translateX(-18px) translateY(-50%)
            transition opacity 180ms ease, transform 180ms ease
            will-change opacity, transform
            background rgba(alpha - 80%, 0.24)
            color alpha + 60%
            border 1px solid rgba(alpha + 20%, 0.18)
            border-radius 12px
            padding 10px 12px
            text-align center
            box-shadow 0 10px 24px rgba(dark, 0.18)
            min-height 3rem

            &.is-show
              opacity 1
              transform translateX(0) translateY(-50%)

          #running-commentary.running-commentary
            position absolute
            top 0
            left 1.3rem
            right 1.3rem
            min-height 5rem
            padding 1rem
            margin 0 auto
            background rgba(alpha - 80%, 0.24)
            color alpha + 50%
            border-radius 8px
            text-align center
            display none
            z-index 2

          .wordle-row
            display grid
            grid-template-columns repeat(5, 1fr)
            gap 8px

            .wordle-tile
              width 4.3rem
              height 4.3rem
              display grid
              place-items center
              border-radius 12px
              background rgba(alpha - 75%, 0.10)
              border 1px solid rgba(alpha + 20%, 0.18)
              color alpha + 60%
              font-weight 800
              font-size 2rem
              text-transform uppercase
              line-height 1
              letter-spacing 0.5px

              &[data-state="empty"]
                background rgba(alpha - 75%, 0.10)
                border 1px solid rgba(alpha + 20%, 0.14)
                color alpha + 55%

              // YOUR mapping:
              // absent  => danger
              &[data-state="absent"]
                background danger
                border 1px solid danger + 20%
                color light !important

              // present => warning
              &[data-state="present"]
                background warning
                border 1px solid warning + 20%
                color dark !important

              // correct => safe
              &[data-state="correct"]
                background safe
                border 1px solid safe + 20%
                color light !important

          &.is-revealing .wordle-tile
            transform-style preserve-3d
            animation wordleFlip 0.52s ease-in-out
            animation-delay calc(var(--i, 0) * 80ms)

        .wordle-keyboard
          display grid
          gap 6px
          justify-content center

          .kb-row
            display flex
            justify-content space-around
            max-width 400px
            width 100vw

            .kb-key
              appearance none
              background rgba(alpha - 70%, 0.14)
              color alpha + 60%
              border 1px solid rgba(alpha + 20%, 0.16)
              border-radius 14px
              padding 8px 8px
              max-width 34px
              max-height 34px
              font-size 1rem
              height 32px
              width 32px
              font-weight 800
              cursor pointer
              touch-action manipulation
              user-select none
              display flex
              align-items center
              justify-content center
              transition background 180ms ease, transform 120ms ease, opacity 180ms ease

              &:hover
                background rgba(alpha - 70%, 0.18)

              &:active
                transform translateY(1px)

              // YOUR mapping:
              // absent  => danger
              &[data-state="absent"]
                background danger
                border 1px solid danger + 20%
                color light !important

              // present => warning
              &[data-state="present"]
                background warning
                border 1px solid warning + 20%
                color dark !important

              // correct => safe
              &[data-state="correct"]
                background safe
                border 1px solid safe + 20%
                color light !important

              &.backspace
                background rgba(alpha - 80%, 0.18)
                width fit-content
                border-radius 12px
                border 1px solid rgba(alpha + 20%, 0.16)
                padding 2px 10px

          .enter-key
            border 1px solid rgba(alpha + 30%, 0.22)
            border-radius 12px
            padding 10px 12px
            background rgba(alpha - 70%, 0.14)
            color alpha + 70%
            margin-top .6rem
            width 100%

            &:hover
              background rgba(alpha - 70%, 0.18)

    .game-footer
      padding 1rem 12px 14px 12px
      margin-top 14px
      display grid
      gap 10px

      .actions
        display flex
        justify-content center
        gap 10px
        flex-wrap wrap
        color alpha

      .btn
        padding 8px 12px
        border 1px solid rgba(alpha + 20%, 0.18)
        border-radius 10px
        background rgba(alpha - 70%, 0.12)
        color alpha + 60%

        &:hover
          background rgba(alpha - 70%, 0.16)

        &:active
          transform translateY(1px)

      .ghost
        background transparent
        border 1px solid rgba(alpha + 20%, 0.22)
        color alpha + 50%

        &:hover
          background rgba(alpha - 70%, 0.10)

      .toast-line
        min-height 20px
        font-size 14px
        opacity 0.95
        color alpha + 55%

      .share-panel
        margin-top 10px
        padding 12px
        border-radius 14px
        border 1px solid rgba(alpha + 20%, 0.16)
        background rgba(alpha - 80%, 0.10)

        .share-title
          margin 0 0 8px 0
          color alpha + 60%

        .share-text
          margin 0
          white-space pre-wrap
          word-break break-word
          padding 10px
          border-radius 12px
          border 1px solid rgba(alpha + 20%, 0.14)
          background rgba(alpha - 80%, 0.12)
          font-variant-numeric tabular-nums
          color alpha + 55%

        .share-actions
          margin-top 10px
          display grid
          grid-template-columns repeat(2, minmax(0, 1fr))
          gap 10px
          align-items stretch

          button
            width 100%
            display inline-flex
            align-items center
            justify-content center

@media (max-width: 360px)
  .wordle-game-wrap
    .wordle-game
      .game-footer
        .share-panel
          .share-actions
            grid-template-columns 1fr

@media (prefers-color-scheme: dark)
  .wordle-game-wrap
    background rgba(dark, 0.20)

    .wordle-game
      background rgba(dark, 0.18)
      border 1px solid rgba(alpha + 20%, 0.16)

      .game-header
        .previous-answers
          box-shadow 0 12px 30px rgba(dark, 0.35)

      .game-stage
        .wordle
          .wordle-board
            .wordle-row-toast
              box-shadow 0 12px 30px rgba(dark, 0.35)

      .game-footer
        .share-panel
          border 1px solid rgba(alpha + 20%, 0.14)
          background rgba(dark, 0.16)

          .share-text
            border 1px solid rgba(alpha + 20%, 0.12)
            background rgba(dark, 0.22)

@keyframes wordleShake
  0%
    transform translateX(0)
  20%
    transform translateX(-6px)
  40%
    transform translateX(6px)
  60%
    transform translateX(-6px)
  80%
    transform translateX(6px)
  100%
    transform translateX(0)

.wordle-row.is-shake
  animation wordleShake 0.42s ease-in-out

@keyframes wordleFlip
  0%
    transform rotateX(0deg)
  50%
    transform rotateX(90deg)
  100%
    transform rotateX(0deg)
