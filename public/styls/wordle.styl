// public/styls/wordle.styl

.wordle-game-wrap
  background alpha - 40%
  width fit-content
  margin 0rem auto
  padding 0

  .wordle-game
    max-width 424px
    margin 0 auto
    border-radius 16px
    width 100vw

    .game-header
      display flex
      flex-direction column
      align-items center
      gap 0
      margin-bottom 14px
      line-height 1
      position relative
      z-index 3

      .game-title
        margin 0
        font-size clamp(22px, 2.4vw, 34px)
        line-height 1
        height 4rem
        display flex
        align-items center
        justify-content center
        text-align center
        border-bottom 1px solid alpha + 20%

      .previous-answers-wrap
        position relative
        margin-top .6rem
        width 100%
        display flex
        flex-direction column
        align-items center
        z-index 50

      .previous-answer-btn
        padding 8px 12px
        border 1px solid alpha
        border-radius 10px
        background alpha - 10%
        color alpha + 60%
        cursor pointer
        width fit-content

        &:active
          transform translateY(1px)

      .previous-answers
        position absolute
        top calc(100% + 8px)
        left 50%
        transform translateX(-50%) translateY(-8px) scale(.98)
        opacity 0
        pointer-events none

        // make it wide so each item stays on one line
        width min(424px, 96vw)

        border 1px solid alpha - 10%
        border-radius 12px
        background alpha - 20%
        color alpha + 60%
        padding 10px
        box-sizing border-box
        z-index 60

        transition opacity 800ms ease, transform 800ms ease

        will-change opacity, transform
        box-shadow 0 12px 30px rgba(0,0,0,.18)

        &.is-open
          opacity 1
          transform translateX(-50%) translateY(0) scale(1)
          pointer-events auto

        .previous-answers-head
          display flex
          justify-content space-between
          align-items center
          margin-bottom 8px

          .previous-answers-title
            font-weight 700
            opacity .95

        .previous-answers-status
          margin 0 0 8px 0
          padding 6px 8px
          border-radius 10px
          background rgba(alpha - 70%, 0.18)
          opacity .95

        .previous-answers-list
          list-style none
          padding 0
          margin 0
          display grid
          gap 6px

          li
            display flex
            justify-content space-between
            align-items center
            flex-wrap nowrap
            gap 12px
            padding 6px 8px
            border-radius 10px
            background rgba(alpha - 70%, 0.18)

            // force a single-line row
            white-space nowrap

            .prev-date
              opacity .9
              font-variant-numeric tabular-nums
              white-space nowrap
              overflow hidden
              text-overflow ellipsis
              min-width 0
              flex 1 1 auto

            .prev-answer
              font-weight 800
              letter-spacing .08em
              text-transform uppercase
              font-variant-numeric tabular-nums
              white-space nowrap
              flex 0 0 auto

      .sub-heading
        position relative
        display flex
        flex-direction column
        align-items center
        justify-content center
        width 100%

      .timer-line,
      .attempts-line,
      .streak-line
        margin 0
        opacity 0.92
        margin auto

      .countdown
        margin-left 8px
        font-variant-numeric tabular-nums

      .attempts-line span
        margin-left 8px
        font-variant-numeric tabular-nums

      .puzzle-picker
        label
          margin-right 8px

    .game-stage
      .wordle
        display grid
        gap 18px
        align-items start
        position relative
        z-index 1

        .wordle-board
          display grid
          gap 8px
          justify-content center
          user-select none
          touch-action manipulation
          position relative

          #running-commentary.running-commentary
            position absolute
            top 0
            left 1.3rem
            right 1.3rem
            min-height 5rem
            padding 1rem
            margin 0 auto
            background alpha - 20%
            color alpha + 50%
            border-radius 8px
            text-align center
            display none
            z-index 2

          .wordle-row
            display grid
            grid-template-columns repeat(5, 1fr)
            gap 8px

            .wordle-tile
              width 4.3rem
              height 4.3rem
              display grid
              place-items center
              border-radius 10px
              border 2px solid var(--w-empty-border)
              background alpha
              font-weight 700
              font-size 2rem
              text-transform uppercase
              line-height 1
              letter-spacing 0.5px

              &[data-state="empty"]
                color alpha + 60%
                border none

              &[data-state="absent"]
                background rgba(alpha - 70%, 0.4)
                color alpha !important
                border none

              &[data-state="present"]
                background rgba(beta, 0.7)
                color alpha + 60% !important
                border none

              &[data-state="correct"]
                background rgba(green, .5)
                color alpha + 60% !important
                border none

          &.is-revealing .wordle-tile
            transform-style preserve-3d
            animation wordleFlip 0.52s ease-in-out
            animation-delay calc(var(--i, 0) * 80ms)

        .wordle-keyboard
          display grid
          gap 6px
          justify-content center

          .kb-row
            display flex
            justify-content space-around
            max-width 400px
            width 100vw

            .kb-key
              appearance none
              background alpha
              color alpha + 60%
              border-radius 50%
              padding 8px 8px
              max-width 32px
              max-height 32px
              font-size 1rem
              height 30px
              width 30px
              font-weight 700
              cursor pointer
              touch-action manipulation
              user-select none
              display flex
              align-items center
              justify-content center
              transition all 1s ease-in-out

              &:active
                transform translateY(1px)

              &[data-state="absent"]
                background rgba(alpha - 70%, 0.4)
                color alpha !important

              &[data-state="present"]
                background rgba(beta, 0.7)
                border none
                color alpha + 50%

              &[data-state="correct"]
                background rgba(green, .5)
                border-color none
                color alpha + 80%

              &.backspace
                background alpha - 20%
                width fit-content
                border-radius 0
                border 1px solid alpha - 20%
                padding 2px 8px

          .enter-key
            border 1px solid alpha
            padding 8px 12px
            color alpha + 80%
            margin-top .6rem
            width 100%

    .game-footer
      padding 1rem
      margin-top 14px
      display grid
      gap 10px

      .actions
        display flex
        justify-content center
        gap 10px
        flex-wrap wrap
        color alpha

      .ghost
        padding 8px 12px
        border 1px solid alpha
        border-radius 8px
        color alpha + 40%

      .toast-line
        min-height 20px
        font-size 14px
        opacity 0.95

      .share-panel
        margin-top 10px
        padding 12px
        border-radius 14px
        border 1px solid rgba(0,0,0,0.14)
        background rgba(0,0,0,0.04)

        .share-title
          margin 0 0 8px 0

        .share-text
          margin 0
          white-space pre-wrap
          word-break break-word
          padding 10px
          border-radius 12px
          border 1px solid rgba(0,0,0,0.12)
          background rgba(0,0,0,0.06)
          font-variant-numeric tabular-nums

        .share-actions
          margin-top 10px
          display flex
          gap 10px
          flex-wrap wrap

@media (prefers-color-scheme: dark)
  .wordle-game-wrap
    .wordle-game
      .game-header
        .previous-answers
          box-shadow 0 12px 30px rgba(0,0,0,.35)

      .game-footer
        .share-panel
          border 1px solid rgba(255,255,255,0.14)
          background rgba(255,255,255,0.06)

          .share-text
            border 1px solid rgba(255,255,255,0.12)
            background rgba(0,0,0,0.25)

@keyframes wordleShake
  0%
    transform translateX(0)
  20%
    transform translateX(-6px)
  40%
    transform translateX(6px)
  60%
    transform translateX(-6px)
  80%
    transform translateX(6px)
  100%
    transform translateX(0)

.wordle-row.is-shake
  animation wordleShake 0.42s ease-in-out

@keyframes wordleFlip
  0%
    transform rotateX(0deg)
  50%
    transform rotateX(90deg)
  100%
    transform rotateX(0deg)
